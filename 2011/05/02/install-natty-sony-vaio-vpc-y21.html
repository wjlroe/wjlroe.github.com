
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>How to Install Ubuntu Natty on the Sony Vaio VPC Y21 S1E - Will Roe&#146;s blog</title>
  <meta name="author" content="Will Roe">

  
  <meta name="description" content="This is a howto guide for installing Ubuntu Natty on the troublesome Sony Vaio VPC-Y21-S1E. I say troublesome because no distribution of Linux &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.wjlr.org.uk/2011/05/02/install-natty-sony-vaio-vpc-y21.html">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Will Roe&#146;s blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href='http://fonts.googleapis.com/css?family=Caudex:400,700,400italic,700italic&subset=latin,greek-ext,greek,latin-ext'
      rel='stylesheet' type='text/css'>
<script type="text/javascript" src="//use.typekit.net/ntz0pdz.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>

<!-- For iPhone 6 Plus with @3× display: -->
<link rel="apple-touch-icon-precomposed" sizes="180x180" href="/images/apple-touch-icon-180x180-precomposed.png">
<!-- For iPad with @2× display running iOS ≥ 7: -->
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/images/apple-touch-icon-152x152-precomposed.png">
<!-- For iPad with @2× display running iOS ≤ 6: -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144-precomposed.png">
<!-- For iPhone with @2× display running iOS ≥ 7: -->
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/images/apple-touch-icon-120x120-precomposed.png">
<!-- For iPhone with @2× display running iOS ≤ 6: -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114-precomposed.png">
<!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≥ 7: -->
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/images/apple-touch-icon-76x76-precomposed.png">
<!-- For the iPad mini and the first- and second-generation iPad (@1× display) on iOS ≤ 6: -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72-precomposed.png">
<!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
<link rel="apple-touch-icon-precomposed" href="/images/apple-touch-icon-57x57-precomposed.png"><!-- 57×57px -->

  
  <script type="text/javascript">
    if(!window.location.href.match(/localhost/) &&
       !window.location.href.match(/\d+\.\d+\.\d+\.\d+/)) {
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-7810285-4']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    }
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Will Roe&#146;s blog</a></h1>
  
  <h2 class="subtitle">
    A variety of geekery
    &raquo;
    <a href="/blog/archives" title="Archives">Archives</a>
  </h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">How to Install Ubuntu Natty on the Sony Vaio VPC Y21 S1E</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2011-05-02T00:00:00+01:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This is a howto guide for installing Ubuntu Natty on the troublesome Sony Vaio VPC-Y21-S1E. I say troublesome because no distribution of Linux installs a fully working system on this laptop to the best of my knowledge, even though the hardware is all very common and not very new. Owning this laptop and running Linux is like going back in time to the early 2000s when installing Linux was a week&#8217;s work on any machine. It&#8217;s horrendous that even distros that favour ease of use by default have yet to achieve good hardware support.</p>

<h2>Step 1 - install Ubuntu</h2>

<p>I used the alternative amd64 ISO image for this (and a USB CDROM drive). The text mode installer worked fine as usual and installed in an hour or so. Not exactly quick, but probably that&#8217;s due to very slow IO on this machine.</p>

<p>Once Ubuntu Natty is installed and reboots into your new system, you will notice a couple of things. Firstly the graphics will be running in some kind of generic mode with the wrong resolution. The native resolution of this panel is the now relatively standard 1366x768 of this class of laptop. Out of the box though, Ubuntu will boot in 1024x768 and it looks horrendous. According to Xorg.0.log it will select the VESA driver instead of the intel one it should be using. This is why it will start in unaccelerated, not much works mode. Needless to say, Unity will not be making an appearance yet. I think this is because there is a regression in the 2.6.36 kernel - according to another user of this laptop, the previous kernel version (2.6.37rc8) should work fine.</p>

<h2>Step 2 - get a working kernel</h2>

<p>You&#8217;re going to need to get the network setup before you can do anything useful. Out of the box, I&#8217;m not sure if the wireless is working or not because no mouse will work. The touchpad does nothing and any mouse I plugged in didn&#8217;t work either. This is extremely poor if even a simple USB mouse won&#8217;t work.</p>

<p>The first thing to try is to get a working kernel installed. I headed here <a href="http://kernel.ubuntu.com/~kernel-ppa/mainline/v2.6.37-rc8-natty/">Index of /~kernel-ppa/mainline/v2.6.37-rc8-natty</a> to get the headers and image packages for the amd64. It&#8217;s pretty difficult to get anything onto the laptop since USB isn&#8217;t working at all under Natty. I tried using a USB flash drive to copy the kernel files over - no luck. So what I did was shorten the kernel-ppa link <a href="http://bit.ly/ieDkmQ">http://bit.ly/ieDkmQ</a>, connected the laptop to my ADSL router with an ethernet cable and downloaded those files. I had to keep telling myself it was in fact still 2011.</p>

<p>Once I&#8217;d installed the older kernel and rebooted, things started to work. The bootup screen was garbled however and I got what looked like a kernel panic, with a stackframe all over the place - but it wasn&#8217;t because I could switch to a random VC and back to the 7th VC and see GDM there. It&#8217;s just a complete mess. I think I&#8217;m gonna have to disable the bootspash stuff because it&#8217;s so incredibly messed up (for every other install of Linux on this laptop I&#8217;ve had to do that).</p>

<h2>Step 3 - Change the default kernel</h2>

<p>We need to change the default kernel that boots to avoid booting a broken kernel every time we turn the laptop on.</p>

<ul>
<li>Set <code>GRUB_DEFAULT=saved</code> in the file <code>/etc/default/grub</code>, so we can set the default kernel.</li>
<li>I wanted to find out what the menuentry is for the kernel I&#8217;ve just installed, so I ran:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>grep menuentry /boot/grub/grub.cfg
</span></code></pre></td></tr></table></div></figure>


<p>This will print out every entry in GRUB. This is all from the <a href="https://help.ubuntu.com/community/Grub2">Grub2</a> page.</p>

<ul>
<li>Now use the appropriate menuentry to set as the default. If you installed the same one I did, then that will be &#8220;Ubuntu, with Linux 2.6.37-020637rc8-generic&#8221;:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo grub-set-default <span class="s1">&#39;Ubuntu, with Linux 2.6.37-020637rc8-generic&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>Save all that to grub:</li>
</ul>


<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sudo update-grub
</span></code></pre></td></tr></table></div></figure>


<p>That&#8217;s it, should be set now. This didn&#8217;t work for me though. With ever release of grub and ubuntu tools, it gets more and more difficult to do simple things. It&#8217;s cool that update-grub can detect all the OSes on your hard drive and boot them (it ignored the other Ubuntu install ironically so it&#8217;s not included in the boot menu, pretty silly bug). But please! the ability to set a default kernel or menuentry should be easy and <em>should work</em>. In the end, I set <code>GRUB_SAVEDEFAULT=true</code> in <code>/etc/default/grub</code> and chose the kernel I wanted so that in future it&#8217;ll boot that one every time. What a joke.</p>

<p>For my sanity, I turned off the bootscreen which, on this laptop is severly broken. Even though I&#8217;ve turned the boot splash off, I still have to switch to another VC and back to 7 to see the GDM login screen. Broken.</p>

<h2>Step 4 - Getting wireless working</h2>

<p>Now we have the mouse working, and USB mice work and graphics are as good as you&#8217;ll probably ever get on Linux (i.e. not great).</p>

<p>Wireless is disabled though and you can&#8217;t enable it from the networking icon (Network Manager). This is an issue I&#8217;ve had with Ubuntu on this machine before and I had to dig around to find out how to force it to be enabled.</p>

<p>Enabling the wirelss is not a simple task. It involves messing around with <code>rfkill</code> and it&#8217;s not a simple matter of running <code>rfkill unblock all</code> either - which is maddening. The wireless card is still soft-blocked after that. (Hard blocked means the hardware switch is off and soft blocked means it&#8217;s turned off in software somewhere).</p>

<p>I couldn&#8217;t find the solution by googling and browsing a million Ubuntu forum threads, but checking my <code>/etc/modprobe.d/</code> directory in the other Ubuntu install pointed the way. You need a file with the following contents:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>blacklist acer-wmi
</span></code></pre></td></tr></table></div></figure>


<p>I called that file <code>blacklist-acer-wmi.conf</code> and this time I remembered to copy it into my Dropbox folder so that I won&#8217;t forget about it again.</p>

<h2>Suspend</h2>

<p>Suspend and resume works with Natty! Yay! It didn&#8217;t work on this laptop with Maverick. So we have <em>some</em> progress.</p>

<h2>Multiple monitors</h2>

<p>I tried plugging a VGA monitor in and it was detected and the correct resolution was selected. Wonderful. However, when I tried to change the layout of the monitors, it messed up completely and I ended up with random desktops being drawn all over the monitors. Unplugging and plugging the monitor in fixed that, with only some minor rendering issues (there was a black border around much of the second desktop that went away when I moved a window around). This sort of thing should have been sorted a long time ago, it&#8217;s tiresome to be messing around with such a mess.</p>

<h2>Other problems</h2>

<ol>
<li>When you launch the Update Manager, it still reports everything is up do date without checking first. This is really stupid, having to click on &#8220;Check&#8221; to download the latest package definitions before it realises there are updates to install. It should take the fact that you&#8217;ve deliberately openned Update Manager for the sole purpose of checking whether your software is up-to-date and not tell you out-of-date information.</li>
<li>Keyboard navigation is still horrible in Gnome (that&#8217;s the Classic desktop thing that Ubuntu puts you in if there are problems with your drivers - very likely).</li>
</ol>


<h2>Summary</h2>

<p>Linux and Ubuntu have a very long way to go before they can start to compete with the commercial alternatives. Although Unity is a refreshing innovation on desktop interfaces, it really needs to be backed up with great hardware support and general ease of use that goes a little more than skin deep.</p>

<p>I think I will be posting a review of Natty later - that will focus on Natty as a working system, rather than specific to this laptop. So far though, having used it for a couple of hours setting up my environment, it&#8217;s a great system. It needs a lot more QA to sort out the hardware and system problems though.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Will Roe</span></span>

      




<time class='entry-date' datetime='2011-05-02T00:00:00+01:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>2</span><span class='date-suffix'>nd</span>, <span class='date-year'>2011</span></span> <span class='time'>12:00 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://blog.wjlr.org.uk/2011/05/02/install-natty-sony-vaio-vpc-y21.html" data-via="wjlroe" data-counturl="http://blog.wjlr.org.uk/2011/05/02/install-natty-sony-vaio-vpc-y21.html" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2011/04/25/parsing-and-ebook-making.html" title="Previous Post: Parsing and ebook making">&laquo; Parsing and ebook making</a>
      
      
        <a class="basic-alignment right" href="/2011/05/05/david-cameron-on-av.html" title="Next Post: David Cameron on AV">David Cameron on AV &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 Will Roe
  <br>
  <span class="credit">Generated using <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
